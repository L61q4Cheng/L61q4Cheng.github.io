<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>非对称算法（RSA篇） | Welcome to L61q4Cheng&#39;Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="概述RSA加密算法是一种非对称加密算法，在RSA算法中，加密密钥（即公开密钥）PK是公开信息，而解密密钥（即秘密密钥）SK是需要保密的。加密算法E和解密算法D也都是公开的。对极大整数做因数分解的难度决定了RSA算法的可靠性。">
<meta property="og:type" content="article">
<meta property="og:title" content="非对称算法（RSA篇）">
<meta property="og:url" content="http://example.com/2021/08/05/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E7%AE%97%E6%B3%95%EF%BC%88RSA%E7%AF%87%EF%BC%89/index.html">
<meta property="og:site_name" content="Welcome to L61q4Cheng&#39;Blog">
<meta property="og:description" content="概述RSA加密算法是一种非对称加密算法，在RSA算法中，加密密钥（即公开密钥）PK是公开信息，而解密密钥（即秘密密钥）SK是需要保密的。加密算法E和解密算法D也都是公开的。对极大整数做因数分解的难度决定了RSA算法的可靠性。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-08-05T10:20:59.300Z">
<meta property="article:modified_time" content="2021-08-07T14:19:07.067Z">
<meta property="article:author" content="L61q4_Cheng">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Welcome to L61q4Cheng'Blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Welcome to L61q4Cheng&#39;Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">一个逆向小白</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-非对称算法（RSA篇）" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/08/05/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E7%AE%97%E6%B3%95%EF%BC%88RSA%E7%AF%87%EF%BC%89/" class="article-date">
  <time class="dt-published" datetime="2021-08-05T10:20:59.300Z" itemprop="datePublished">2021-8-5</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      非对称算法（RSA篇）
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>RSA加密算法是一种非对称加密算法，在RSA算法中，加密密钥（即公开密钥）PK是公开信息，而解密密钥（即秘密密钥）SK是需要保密的。加密算法E和解密算法D也都是公开的。对极大整数做因数分解的难度决定了RSA算法的可靠性。</p>
<span id="more"></span>
<h3 id="加密原理"><a href="#加密原理" class="headerlink" title="加密原理"></a>加密原理</h3><h4 id="一、生成公钥和私钥"><a href="#一、生成公钥和私钥" class="headerlink" title="一、生成公钥和私钥"></a>一、生成公钥和私钥</h4><ol>
<li>随机生成两个素数P、Q。</li>
<li>将P、Q两个素数相乘得到一个数N。</li>
<li>计算N的欧拉函数M，M=(P-1)*(Q-1)。</li>
<li>选择一个整数E使其与M互质。</li>
<li>给定一个整数D，使得(E*D)%M=1。</li>
<li>得到N、E、D三个数，其中（N、E）作为公钥，（N、D）作为私钥（公钥和私钥可以互换）。<h4 id="二、生成密文"><a href="#二、生成密文" class="headerlink" title="二、生成密文"></a>二、生成密文</h4>使用公钥（N、E）对data进行加密。<br>加密过程：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data^E mod N = [data]</span><br></pre></td></tr></table></figure>
<h4 id="三、密文解密"><a href="#三、密文解密" class="headerlink" title="三、密文解密"></a>三、密文解密</h4>使用私钥（N、D）对密文进行解密。<br>解密过程：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[data]^D mod N = data</span><br></pre></td></tr></table></figure>
<h3 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h3><h4 id="java"><a href="#java" class="headerlink" title="java"></a>java</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">public class RSA &#123;</span><br><span class="line">    private int N;  // 和公钥E一起分发出去</span><br><span class="line">    private int E; // E是公钥，随机选取（必须和T互质）</span><br><span class="line">    private int D; // D是密钥（D和E可以互换）</span><br><span class="line">    public RSA() &#123;</span><br><span class="line">        createKey();</span><br><span class="line">    &#125;</span><br><span class="line">    // 产生密钥</span><br><span class="line">    private void createKey() &#123;</span><br><span class="line">        // 产生两个随机的素数</span><br><span class="line">        int p=61,q=53;</span><br><span class="line">        // 计算N和T</span><br><span class="line">        N = p*q;</span><br><span class="line">        int t = (p-1)*(q-1);</span><br><span class="line">        // 选择E（和T互质就行）</span><br><span class="line">        E = 17;</span><br><span class="line">        // 计算D</span><br><span class="line">        int[] r = new int[2];</span><br><span class="line">        Gcd.extendGcd(E, t, r); // 调用扩充欧几里得算法计算D</span><br><span class="line">        D = r[0];</span><br><span class="line">        // 调整d（d为正数）</span><br><span class="line">        while(D &lt; 0) D +=t;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 利用公钥对密文m加密</span><br><span class="line">     * @param m 必须是整数，且m必须小于N</span><br><span class="line">     * @return c=pow(m,E)%N</span><br><span class="line">     */</span><br><span class="line">    public int encrypt(int m) &#123; // 注意，这里很容易溢出（虽然此算法已经极度简化了）</span><br><span class="line">        BigInteger bm = BigInteger.valueOf(m);</span><br><span class="line">        return bm.pow(E).mod(BigInteger.valueOf(N)).intValue();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 利用密钥对明文c解密</span><br><span class="line">     * @param c</span><br><span class="line">     * @return m1=pow(c, D)%N</span><br><span class="line">     */</span><br><span class="line">    public int decrypt(int c) &#123; // 同样考虑溢出情况</span><br><span class="line">        BigInteger bc = BigInteger.valueOf(c);</span><br><span class="line">        return bc.pow(D).mod(BigInteger.valueOf(N)).intValue();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public int getPublicKey() &#123;</span><br><span class="line">        return E;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setPublicKey(int E) &#123;</span><br><span class="line">        this.E = E;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public int getN() &#123;</span><br><span class="line">        return N;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setN(int N) &#123;</span><br><span class="line">        this.N = N;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        RSA rsa = new RSA();</span><br><span class="line">        System.out.println(&quot;公钥：E=&quot;+rsa.getPublicKey()+&quot;,N=&quot;+rsa.getN()); // 打印公钥</span><br><span class="line">        int m = 65; // 明文</span><br><span class="line">        System.out.println(&quot;密文：&quot;+m);</span><br><span class="line">        int c = rsa.encrypt(m); // 对明文m加密，得到密文c</span><br><span class="line">        System.out.println(&quot;明文：&quot;+c);</span><br><span class="line">        int m1 = rsa.decrypt(c); // 对密文c解密，得到明文m1</span><br><span class="line">        System.out.println(&quot;解密出来的密文：&quot;+m1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="python"><a href="#python" class="headerlink" title="python"></a>python</h4></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># -*- coding: cp936 -*-</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def isPrime(number):</span><br><span class="line">    import math</span><br><span class="line">    i = 2</span><br><span class="line">    sqrtnum = (int)(math.sqrt(number))</span><br><span class="line">    for i in range(2, sqrtnum + 1):</span><br><span class="line">        if number % i == 0:</span><br><span class="line">            return False</span><br><span class="line">        i = i + 1</span><br><span class="line">    return True</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def is_ET_Prime(ee, tt):</span><br><span class="line">    while tt != 0:</span><br><span class="line">        a = ee</span><br><span class="line">        ee = tt</span><br><span class="line">        tt = a % tt</span><br><span class="line">    if ee == 1:</span><br><span class="line">        return True</span><br><span class="line">    else:</span><br><span class="line">        return False</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_publickey(k, t):</span><br><span class="line">    d = 0</span><br><span class="line">    while ((d * k) % t != 1):</span><br><span class="line">        d += 1</span><br><span class="line">    return d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def encryption(plain, d, n):</span><br><span class="line">    re = (plain ** d) % n</span><br><span class="line"></span><br><span class="line">    return re</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    print</span><br><span class="line">    &quot;~&quot; * 70</span><br><span class="line">    Flag = False</span><br><span class="line">    while True:</span><br><span class="line">        p = int(input(&quot;please input a prime p:&quot;))</span><br><span class="line">        q = int(input(&quot;please input a prime q:&quot;))</span><br><span class="line"></span><br><span class="line">        if (isPrime(p) and isPrime(q)):</span><br><span class="line">            break</span><br><span class="line">        else:</span><br><span class="line">            print</span><br><span class="line">            &quot;p or q is not prime!&quot;</span><br><span class="line">            continue</span><br><span class="line"></span><br><span class="line">    print</span><br><span class="line">    &quot;p=&quot;, p, &quot;q=&quot;, q</span><br><span class="line"></span><br><span class="line">    n = q * p</span><br><span class="line">    t = (q - 1) * (p - 1)</span><br><span class="line">    print(&quot;n=&quot;, n, &quot;t=&quot;, t)</span><br><span class="line"></span><br><span class="line">    print(&quot;~&quot; * 70)</span><br><span class="line"></span><br><span class="line">    Flag == False</span><br><span class="line">    while Flag == False:</span><br><span class="line">        e = int(input(&quot;please input a private key:&quot;))</span><br><span class="line">        Flag = is_ET_Prime(e, t)</span><br><span class="line">        if Flag == False:</span><br><span class="line">            print(&quot;e is not prime with the t!&quot;)</span><br><span class="line"></span><br><span class="line">    print(&quot;the private key e=&quot;, e)</span><br><span class="line"></span><br><span class="line">    d = get_publickey(e, t)</span><br><span class="line">    print(&quot;the public key d=&quot;, d)</span><br><span class="line"></span><br><span class="line">    plain = int(ord(input(&quot;please input the plain you want to entrypted:&quot;)))</span><br><span class="line"></span><br><span class="line">    encry = encryption(plain, d, n)</span><br><span class="line">    print(&quot;plain&quot;, plain, &quot;is encrypted as&quot;, encry)</span><br><span class="line">    #print(encry)</span><br><span class="line">    plain1 = encryption(encry, e, n)</span><br><span class="line">    print(&quot;encrypt&quot;, encry, &quot;is decrypted as&quot;, plain1)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/08/05/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E7%AE%97%E6%B3%95%EF%BC%88RSA%E7%AF%87%EF%BC%89/" data-id="ckryruu9m0001t8twh3bg9g7c" data-title="非对称算法（RSA篇）" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2021/08/05/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">后一篇</strong>
      <div class="article-nav-title">非对称加密算法</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">八月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">七月 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/08/05/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E7%AE%97%E6%B3%95%EF%BC%88RSA%E7%AF%87%EF%BC%89/">非对称算法（RSA篇）</a>
          </li>
        
          <li>
            <a href="/2021/08/05/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/">非对称加密算法</a>
          </li>
        
          <li>
            <a href="/2021/07/27/SHA-1/">加密算法（SHA-1篇）</a>
          </li>
        
          <li>
            <a href="/2021/07/22/%E5%AF%B9%E7%A7%B0%E7%AE%97%E6%B3%95%EF%BC%88DES%E7%AF%87%EF%BC%89/">对称算法（DES篇）</a>
          </li>
        
          <li>
            <a href="/2021/07/22/Dalvik%E6%8C%87%E4%BB%A4%E9%9B%86/">Dalvik指令集</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 L61q4_Cheng<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>